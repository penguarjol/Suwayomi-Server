@file:Suppress("ktlint")
package gg.jte.generated.precompiled
import suwayomi.tachidesk.i18n.MR
@Suppress("UNCHECKED_CAST", "UNUSED_PARAMETER")
class JteWebviewGenerated {
companion object {
	@JvmField val JTE_NAME = "Webview.kte"
	@JvmField val JTE_LINE_INFO = intArrayOf(0,0,0,2,2,2,2,2,8,8,8,8,26,26,26,216,309,309,309,312,312,312,312,312,312,312,312,312,315,315,315,317,317,317,320,320,320,332,332,332,333,333,333,333,333,333,333,333,333,335,335,335,344,344,344,346,346,346,347,347,347,347,347,347,347,347,347,348,348,348,349,349,349,349,349,349,349,349,349,352,352,352,380,381,455,456,493,494,495,499,527,527,527,531,531,531,552,571,588,588,588,630,630,630,635,643,645,661,706,731,732,733,760,760,760,768,768,768,2,2,2,2,2)
	@JvmStatic fun render(jteOutput:gg.jte.html.HtmlTemplateOutput, jteHtmlInterceptor:gg.jte.html.HtmlInterceptor?, locale:java.util.Locale) {
		jteOutput.writeContent("\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, interactive-widget=resizes-content\" />\n    <title>")
		jteOutput.setContext("title", null)
		jteOutput.writeUserContent(MR.strings.webview_label_title.localized(locale))
		jteOutput.writeContent("</title>\n    <style>\n        * {\n            box-sizing: border-box;\n        }\n        html, body {\n            margin: 0;\n            padding: 0;\n            height: 100%;\n        }\n        body {\n            display: flex;\n            flex-direction: column;\n            font-family: \"Roboto\",\"Helvetica\",\"Arial\",sans-serif;\n            font-weight: 400;\n            letter-spacing: 0em;\n        }\n        body.disconnected::after {\n            content: \"")
		jteOutput.setContext("style", null)
		jteOutput.writeUserContent(MR.strings.webview_label_disconnected.localized(locale))
		jteOutput.writeContent("\";\n            position: absolute;\n            inset: 0;\n            background: rgba(150, 0, 0, 0.5);\n            color: white;\n            text-align: center;\n            align-content: center;\n            font-size: 2rem;\n        }\n        button[disabled], input[disabled] {\n            cursor: not-allowed;\n        }\n        header {\n            background-color: rgb(34, 38, 53);\n            box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 4px -1px, rgba(0, 0, 0, 0.14) 0px 4px 5px 0px, rgba(0, 0, 0, 0.12) 0px 1px 10px 0px;\n            color: #fff;\n            padding: 8px 32px;\n        }\n        header h1, header p {\n            margin: 0;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n        header nav {\n            display: flex;\n            flex-wrap: wrap;\n            column-gap: 20px;\n            align-items: center;\n        }\n        header form {\n            display: flex;\n            gap: 5px;\n            flex: auto 1 1;\n            min-width: 400px;\n        }\n        header label {\n            flex: auto 0 0;\n            cursor: pointer;\n        }\n        header button {\n            all: unset;\n            padding: 8px;\n            border-radius: 50%;\n            min-width: 1em;\n            line-height: 1;\n            text-align: center;\n        }\n        header button:not([disabled]) {\n            cursor: pointer;\n        }\n        header button:not([disabled]):hover {\n            background-color: rgba(255, 255, 255, 0.08);\n        }\n        header input {\n            flex: 100% 1 1;\n        }\n        main, iframe {\n            height: 100%;\n        }\n        main {\n            position: relative;\n        }\n        canvas, input#inputtrap {\n            position: absolute;\n            inset: 0;\n            width: 100%;\n            height: 100%;\n        }\n        input#inputtrap {\n            opacity: 0;\n            padding: 0;\n            margin: 0;\n            border: none;\n        }\n        main .message, main .status {\n            position: relative;\n            z-index: 1;\n        }\n        main .message {\n            padding: 8px;\n            max-width: 1100px;\n            margin: auto;\n            font-style: italic;\n        }\n        main .message.error {\n            color: red;\n            font-style: regular;\n            font-weight: bold;\n        }\n        main .message:empty {\n            display: none;\n        }\n        main .status {\n            position: absolute;\n            bottom: 0;\n            left: 0;\n            max-width: 50%;\n            background: #555;\n            color: white;\n            padding: 2px 4px;\n            font-size: 0.8rem;\n            border-top-right-radius: 3px;\n        }\n        main .status:empty {\n            display: none;\n        }\n        main .contextmenu {\n            display: none;\n            position: absolute;\n            right: 0;\n            max-width: fit-content;\n            min-height: calc(1.5em + 2px + 2px + 4px);\n            min-width: 120px;\n            flex-wrap: wrap;\n            border-radius: 4px;\n            border: 1px solid #333;\n        }\n        main .contextmenu.show {\n            display: flex;\n        }\n        main .contextmenu button {\n            all: unset;\n            line-height: 1.5;\n            flex-grow: 1;\n            background: white;\n            transition: background 0.1s ease-in-out;\n            cursor: pointer;\n            border: 0.5px solid #666;\n            padding: 2px 4px;\n            text-align: center;\n        }\n        main .contextmenu button:hover {\n            background: #eee;\n        }\n        .copydialog, .logindialog {\n            display: none;\n            position: absolute;\n            inset: 0;\n            width: 100%;\n            height: 100%;\n            padding: 6px;\n            z-index: 1;\n        }\n        .copydialog.show, .logindialog.show {\n            display: block;\n        }\n        .copydialog::before, .logindialog::before {\n            content: '';\n            position: absolute;\n            inset: 0;\n            background: black;\n            opacity: 0.3;\n        }\n        .copydialog__inner, .logindialog__inner {\n            position: relative;\n            max-width: 960px;\n            border-radius: 8px;\n            border: 1px solid #333;\n            background: #eee;\n            padding: 8px;\n            margin: auto;\n            height: 100%;\n        }\n        .copydialog__title {\n            display: flex;\n            flex-wrap: nowrap;\n            justify-content: space-between;\n        }\n        .copydialog input {\n            width: 100%;\n        }\n        .copydialog .close {\n            flex-shrink: 1;\n            all: unset;\n            cursor: pointer;\n            align-self: start;\n            font-size: 2rem;\n            line-height: 1;\n        }\n        @media (min-width: 500px) {\n            .copydialog, .logindialog {\n                padding: 24px;\n            }\n            .copydialog__inner, .logindialog__inner {\n                padding: 12px 18px;\n                height: auto;\n            }\n        }\n\n        ")
		jteOutput.writeContent("\n        .arrow-right {\n            display: inline-block;\n            width: 0;\n            height: 0;\n            border-top: 9px solid transparent;\n            border-bottom: 9px solid transparent;\n            border-left: 9px solid currentcolor;\n        }\n\n        .logindialog .error {\n            margin: 8px;\n            padding: 8px 16px;\n            border-radius: 8px;\n            border: 1px solid #b71c1c;\n            background-color: #c62828;\n            color: white;\n        }\n        .logindialog .error:empty {\n            display: none;\n        }\n        .logindialog form label {\n            cursor: pointer;\n        }\n        .logindialog form button {\n            all: unset;\n            padding: 8px;\n            line-height: 1.75;\n            text-align: center;\n            min-width: 64px;\n            border-radius: 4px;\n            padding: 6px 8px;\n            color: rgb(91, 116, 239);\n            text-transform: uppercase;\n            letter-spacing: 0.02857em;\n        }\n        .logindialog form button:not([disabled]) {\n            cursor: pointer;\n        }\n        .logindialog form button:not([disabled]):hover {\n            background-color: rgba(91, 116, 239, 0.08);\n        }\n        .logindialog form input {\n            all: unset;\n            border-radius: 4px;\n            border: 1px solid rgba(255, 255, 255, 0.23);\n            padding: 6px 12px;\n            width: auto;\n            min-width: 0;\n        }\n        .logindialog form input:hover {\n            border-color: white;\n        }\n        .logindialog form input:focus {\n            border-color: rgb(91, 116, 239);\n        }\n        .logindialog form .controls {\n            display: grid;\n            align-items: center;\n            grid-template-columns: 1fr;\n        }\n        .logindialog form .controls > :nth-child(even):not(:last-child) {\n            margin-bottom: 6px;\n        }\n        .logindialog form .submit {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            margin-top: 24px;\n        }\n        .logindialog input:disabled, .logindialog button:disabled {\n            opacity: 0.7;\n        }\n\n        @media (min-width: 500px) {\n            .logindialog form {\n                width: 100%;\n                max-width: 450px;\n                margin: 8px auto;\n            }\n            .logindialog form .controls {\n                grid-template-columns: auto 1fr;\n                column-gap: 16px;\n                row-gap: 6px;\n            }\n            .logindialog form .controls > :nth-child(even):not(:last-child) {\n                margin-bottom: 0px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <header>\n        <h1 id=\"title\">")
		jteOutput.setContext("h1", null)
		jteOutput.writeUserContent(MR.strings.webview_label_title.localized(locale))
		jteOutput.writeContent("</h1>\n        <nav>\n            <form id=\"browseForm\">\n                <input type=\"text\" id=\"url\" name=\"url\"")
		val __jte_html_attribute_0 = MR.strings.webview_placeholder_url.localized(locale)
		if (gg.jte.runtime.TemplateUtils.isAttributeRendered(__jte_html_attribute_0)) {
			jteOutput.writeContent(" placeholder=\"")
			jteOutput.setContext("input", "placeholder")
			jteOutput.writeUserContent(__jte_html_attribute_0)
			jteOutput.setContext("input", null)
			jteOutput.writeContent("\"")
		}
		jteOutput.writeContent(" disabled/>\n                <button type=\"submit\" id=\"goButton\" disabled><span class=\"arrow-right\"></span></button>\n            </form>\n            <label><input type=\"checkbox\" id=\"reverseScroll\" disabled/> ")
		jteOutput.setContext("label", null)
		jteOutput.writeUserContent(MR.strings.webview_label_reversescroll.localized(locale))
		jteOutput.writeContent("</label>\n        </nav>\n      <p><i>")
		jteOutput.setContext("i", null)
		jteOutput.writeUserContent(MR.strings.webview_label_bindingshint.localized(locale))
		jteOutput.writeContent("</i></p>\n    </header>\n    <main>\n        <div class=\"message\" id=\"message\">")
		jteOutput.setContext("div", null)
		jteOutput.writeUserContent(MR.strings.webview_label_init.localized(locale))
		jteOutput.writeContent("</div>\n        <div class=\"status\" id=\"status\"></div>\n        <canvas id=\"frame\"></canvas>\n        <input type=\"text\" id=\"inputtrap\" autocomplete=\"off\"/>\n        <div class=\"contextmenu\" id=\"contextmenu\" role=\"menu\">\n            <button type=\"button\" id=\"menu_copy\" role=\"menuitem\">Copy</button>\n            <button type=\"button\" id=\"menu_paste\" role=\"menuitem\">Paste</button>\n        </div>\n    </main>\n    <div class=\"copydialog\" id=\"copydialog\" role=\"dialog\">\n        <div class=\"copydialog__inner\">\n            <div class=\"copydialog__title\">\n                <h2>")
		jteOutput.setContext("h2", null)
		jteOutput.writeUserContent(MR.strings.webview_label_copy.localized(locale))
		jteOutput.writeContent("</h2>\n                <button type=\"button\" class=\"close\" id=\"copyclose\"")
		val __jte_html_attribute_1 = MR.strings.label_close.localized(locale)
		if (gg.jte.runtime.TemplateUtils.isAttributeRendered(__jte_html_attribute_1)) {
			jteOutput.writeContent(" title=\"")
			jteOutput.setContext("button", "title")
			jteOutput.writeUserContent(__jte_html_attribute_1)
			jteOutput.setContext("button", null)
			jteOutput.writeContent("\"")
		}
		jteOutput.writeContent(">&times;</button>\n            </div>\n            <p>")
		jteOutput.setContext("p", null)
		jteOutput.writeUserContent(MR.strings.webview_label_copy_description.localized(locale))
		jteOutput.writeContent("</p>\n            <input type=\"text\" id=\"copyinput\" disabled readonly/>\n        </div>\n    </div>\n    <div class=\"logindialog\" id=\"logindialog\" role=\"dialog\">\n        <div class=\"logindialog__inner\">\n            <form>\n                <h2>Login</h2>\n                <div class=\"error\"></div>\n                <p>")
		jteOutput.setContext("p", null)
		jteOutput.writeUserContent(MR.strings.webview_label_login_required.localized(locale))
		jteOutput.writeContent("</p>\n                <div class=\"controls\">\n                    <label for=\"user\">")
		jteOutput.setContext("label", null)
		jteOutput.writeUserContent(MR.strings.login_label_username.localized(locale))
		jteOutput.writeContent(":</label>\n                    <input type=\"text\" name=\"user\" id=\"user\" required")
		val __jte_html_attribute_2 = MR.strings.login_placeholder_username.localized(locale)
		if (gg.jte.runtime.TemplateUtils.isAttributeRendered(__jte_html_attribute_2)) {
			jteOutput.writeContent(" placeholder=\"")
			jteOutput.setContext("input", "placeholder")
			jteOutput.writeUserContent(__jte_html_attribute_2)
			jteOutput.setContext("input", null)
			jteOutput.writeContent("\"")
		}
		jteOutput.writeContent("/>\n                    <label for=\"pass\">")
		jteOutput.setContext("label", null)
		jteOutput.writeUserContent(MR.strings.login_label_password.localized(locale))
		jteOutput.writeContent(":</label>\n                    <input type=\"password\" name=\"pass\" id=\"pass\" required")
		val __jte_html_attribute_3 = MR.strings.login_placeholder_password.localized(locale)
		if (gg.jte.runtime.TemplateUtils.isAttributeRendered(__jte_html_attribute_3)) {
			jteOutput.writeContent(" placeholder=\"")
			jteOutput.setContext("input", "placeholder")
			jteOutput.writeUserContent(__jte_html_attribute_3)
			jteOutput.setContext("input", null)
			jteOutput.writeContent("\"")
		}
		jteOutput.writeContent("/>\n                </div>\n                <div class=\"submit\">\n                    <button type=\"submit\" disabled>")
		jteOutput.setContext("button", null)
		jteOutput.writeUserContent(MR.strings.login_label_login.localized(locale))
		jteOutput.writeContent("</button>\n                </div>\n            </form>\n        </div>\n    </div>\n    <script>\n        const messageDiv = document.getElementById('message');\n        const statusDiv = document.getElementById('status');\n        const copyDiv = document.getElementById('copydialog');\n        const copyInput = document.getElementById('copyinput');\n        const copyClose = document.getElementById('copyclose');\n        const contextMenuDiv = document.getElementById('contextmenu');\n        const contextMenuCopy = document.getElementById('menu_copy');\n        const contextMenuPaste = document.getElementById('menu_paste');\n        const frame = document.getElementById('frame');\n        const frameInput = document.getElementById('inputtrap');\n        const ctx = frame.getContext(\"2d\");\n        const browseForm = document.getElementById('browseForm');\n        const goButton = document.getElementById('goButton');\n        const urlInput = document.getElementById('url');\n        const titleDiv = document.getElementById('title');\n        const reverseToggle = document.getElementById('reverseScroll');\n        const origTitle = document.title;\n        const params = new URLSearchParams(window.location.search);\n        const token = params.get('token');\n\n        function connectWs(socketUrl, token) {\n            return new Promise((resolve, reject) => {\n                ")
		jteOutput.writeContent("\n                ")
		jteOutput.writeContent("\n                const socket = new WebSocket(socketUrl, token ? [token] : []);\n                const f = (msg) => {\n                    console.debug('Connection active:', msg.data);\n                    socket.removeEventListener('message', f);\n                    socket.removeEventListener('close', closef);\n                    resolve(socket);\n                };\n                const closef = (e) => {\n                    socket.removeEventListener('message', f);\n                    if (e.code === 1011 && e.reason === \"Unauthorized\") {\n                        const loginDiv = document.getElementById('logindialog');\n                        const loginForm = document.querySelector('#logindialog form');\n                        const loginError = document.querySelector('#logindialog .error');\n                        loginError.textContent = '';\n                        loginForm.querySelectorAll('input, button').forEach(i => i.disabled = false);\n                        loginForm.addEventListener('submit', async (sev) => {\n                            sev.preventDefault();\n                            loginForm.querySelectorAll('input, button').forEach(i => i.disabled = true);\n                            const mutation = {\n                                \"query\": \"mutation LOGIN(\$input: LoginInput!) {\\n  login(input: \$input) {\\n    accessToken\\n    refreshToken\\n  }\\n}\",\n                                \"variables\": {\n                                    \"input\": {\n                                        \"username\": loginForm.user.value,\n                                        \"password\": loginForm.pass.value,\n                                    },\n                                },\n                                \"operationName\": \"LOGIN\",\n                            };\n                            const resp = await fetch(\"/api/graphql\", {\n                                \"headers\": {\n                                    \"Accept\": \"application/json, multipart/mixed\",\n                                    \"Content-Type\": \"application/json\",\n                                    \"Cache-Control\": \"no-cache\"\n                                },\n                                \"body\": JSON.stringify(mutation),\n                                \"method\": \"POST\",\n                            }).then(r => r.json());\n                            if (resp.errors && resp.errors.length > 0) {\n                                const err = resp.errors[0].message.replace(/Exception[^:]* :|\\r?\\n.*/g, '');\n                                loginError.textContent = err;\n                                loginForm.pass.value = '';\n                                loginForm.querySelectorAll('input, button').forEach(i => i.disabled = false);\n                            } else {\n                                const newToken = resp.data.login.accessToken;\n                                const expiry = new Date(JSON.parse(atob(newToken.split('.')[1])).exp * 1000);\n                                console.log('Got new token', newToken, 'expires', expiry);\n                                document.cookie = \"suwayomi-server-token=\" + newToken + \"; path=/; expires=\" + expiry.toUTCString();\n                                loginDiv.classList.remove('show');\n                                loginForm.querySelectorAll('input, button').forEach(i => i.disabled = true);\n                                const newSocket = new WebSocket(socketUrl, [newToken]);\n                                newSocket.addEventListener('open', () => {\n                                    resolve(newSocket);\n                                });\n                            }\n                        });\n                        loginDiv.classList.add('show');\n                        return;\n                    }\n                    socket.removeEventListener('close', closef);\n                    reject(e);\n                };\n                socket.addEventListener('open', () => {\n                    console.debug('Socket opened, PING');\n                    socket.addEventListener('message', f);\n                    socket.send(JSON.stringify({type: \"ping\"}));\n                });\n                socket.addEventListener('close', closef);\n            });\n        }\n\n        (async function() {\n            try {\n                const socketUrl = (window.location.origin + window.location.pathname).replace(/^http/,'ws');\n                ")
		jteOutput.writeContent("\n                ")
		jteOutput.writeContent("\n                const socket = await connectWs(socketUrl, token);\n\n                urlInput.disabled = false;\n                goButton.disabled = false;\n                reverseToggle.disabled = false;\n                reverseToggle.checked = window.localStorage.getItem('suwayomi_mouse_reverse_scroll') === \"true\";\n\n                let url = '';\n                try {\n                    url = window.decodeURIComponent(window.location.hash.replace(/^#/, ''));\n                } catch (e) {\n                    console.error(e);\n                }\n\n                copyClose.addEventListener('click', () => {\n                    copyDiv.classList.remove('show');\n                });\n\n                contextMenuCopy.addEventListener('click', () => {\n                    socket.send(JSON.stringify({\n                        type: 'copy',\n                    }));\n                    contextMenuDiv.classList.remove('show');\n                });\n\n                contextMenuPaste.addEventListener('click', () => {\n                    navigator.clipboard.readText().then(data => {\n                        socket.send(JSON.stringify({\n                            type: 'paste',\n                            data: data,\n                        }));\n                    });\n                    contextMenuDiv.classList.remove('show');\n                });\n\n                if (!navigator.clipboard || !navigator.clipboard.readText) {\n                    ")
		jteOutput.writeContent("\n                    ")
		jteOutput.writeContent("\n                    ")
		jteOutput.writeContent("\n                    contextMenuPaste.remove();\n                }\n\n                ")
		jteOutput.writeContent("\n\n                const setHash = (u) => {\n                    let current = '';\n                    try {\n                        current = window.decodeURIComponent(window.location.hash.replace(/^#/, ''));\n                    } catch (e) {\n                        console.error(e);\n                    }\n                    if (current != u)\n                        history.pushState(null, null, window.location.origin + window.location.pathname + '#' + window.encodeURIComponent(u));\n                };\n\n                const setTitle = (title) => {\n                    if (!title) {\n                        document.title = origTitle;\n                        titleDiv.textContent = origTitle;\n                    } else {\n                        document.title = \"Suwayomi: \" + title;\n                        titleDiv.textContent = \"Suwayomi: \" + title;\n                    }\n                }\n\n                const loadUrl = (u) => {\n                    if (!u) {\n                        urlInput.value = u;\n                        setHash(u);\n                        setTitle();\n                        messageDiv.textContent = \"")
		jteOutput.setContext("script", null)
		jteOutput.writeUserContent(MR.strings.webview_label_getstarted.localized(locale))
		jteOutput.writeContent("\";\n                        ctx.clearRect(0, 0, frame.width, frame.height);\n                        return;\n                    }\n                    messageDiv.textContent = \"")
		jteOutput.setContext("script", null)
		jteOutput.writeUserContent(MR.strings.webview_label_loading.localized(locale))
		jteOutput.writeContent("\";\n                    messageDiv.classList.remove('error');\n                    urlInput.value = u;\n                    socket.send(JSON.stringify({ type: 'loadUrl', url: u, width: frame.clientWidth, height: frame.clientHeight }));\n                    ctx.clearRect(0, 0, frame.width, frame.height);\n                };\n\n                const copy = (data) => {\n                    try {\n                        if (!!navigator.clipboard && !!navigator.clipboard.writeText) {\n                            navigator.clipboard.writeText(data);\n                            return;\n                        }\n                        console.warn('Clipbaord API not supported (not served over HTTPS?), presenting dialog');\n                    } catch (e) {\n                        console.error('Clipboard access threw, presenting dialog', e);\n                    }\n                    copyInput.value = data;\n                    copyDiv.classList.add('show');\n                }\n\n                ")
		jteOutput.writeContent("\n\n                window.addEventListener('hashchange', e => {\n                    const url = window.decodeURIComponent(window.location.hash.replace(/^#/, ''));\n                    loadUrl(url);\n                    console.log('Navigate to', url);\n                });\n\n                browseForm.addEventListener('submit', e => {\n                    e.preventDefault();\n                    const url = urlInput.value;\n                    loadUrl(url);\n                    console.log('Navigate to', url);\n                });\n\n                reverseToggle.addEventListener('change', e => {\n                    window.localStorage.setItem('suwayomi_mouse_reverse_scroll', e.target.checked ? \"true\" : \"false\");\n                });\n\n                ")
		jteOutput.writeContent("\n\n                socket.addEventListener('message', e => {\n                    const obj = JSON.parse(e.data);\n                    switch (obj.type) {\n                        case \"addressChange\":\n                            console.log('Loaded');\n                            messageDiv.textContent = '';\n                            urlInput.value = obj.url;\n                            setHash(obj.url);\n                            setTitle(obj.title);\n                            break;\n                        case \"statusChange\":\n                            statusDiv.textContent = obj.message;\n                            break;\n                        case \"load\": {\n                            if (obj.error) {\n                                messageDiv.textContent = \"")
		jteOutput.setContext("script", null)
		jteOutput.writeUserContent(MR.strings.label_error.localized(locale))
		jteOutput.writeContent(": \" + obj.error;\n                                messageDiv.classList.add('error');\n                            } else {\n                                messageDiv.textContent = \"\";\n                            }\n                            urlInput.value = obj.url;\n                            setTitle(obj.title);\n                        } break;\n                        case \"render\": {\n                            const img = new Image();\n                            const imgData = new Blob([new Uint8Array(obj.image)], { type: \"image/png\" });\n                            const url = URL.createObjectURL(imgData);\n                            img.addEventListener('load', e => {\n                                frame.width = img.width;\n                                frame.height = img.height;\n                                ctx.drawImage(img, 0, 0);\n                            });\n                            img.src = url;\n                        } break;\n                        case \"consoleMessage\": {\n                            const lg = obj.severity == 4 ? console.error : obj.severity == 3 ? console.warn : console.log;\n                            lg(obj.source + ':' + obj.line + ':', obj.message);\n                        } break;\n                        case \"copy\":\n                            copy(obj.content);\n                            break;\n                        default:\n                            console.warn(\"Unknown event\", obj.type)\n                            break;\n                    }\n                });\n\n                socket.addEventListener('close', e => {\n                    if (e.wasClean) {\n                        console.log(`WebSocket connection closed cleanly, code=` + e.code + `, reason=` + e.reason);\n                    } else {\n                        console.error('WebSocket connection died', e);\n                    }\n                    document.body.classList.add('disconnected');\n                });\n\n                socket.addEventListener('error', e => {\n                    messageDiv.textContent = \"")
		jteOutput.setContext("script", null)
		jteOutput.writeUserContent(MR.strings.label_error.localized(locale))
		jteOutput.writeContent(": \" + (e.message || e.reason || e);\n                    messageDiv.classList.add('error');\n                    console.error('WebSocket error:', e);\n                });\n\n                ")
		jteOutput.writeContent("\n\n                const observer = new ResizeObserver(() => {\n                    socket.send(JSON.stringify({ type: 'resize', width: frame.clientWidth, height: frame.clientHeight }));\n                });\n                observer.observe(frame);\n\n                const frameEvent = (e) => {\n                    ")
		jteOutput.writeContent("\n                    if (e.key === \"Unidentified\") return;\n                    ")
		jteOutput.writeContent("\n                    if (e.key === \"v\" && e.ctrlKey === true) return;\n                    if (e.key === \"c\" && e.ctrlKey === true) {\n                        if (e.type === \"keydown\") {\n                            socket.send(JSON.stringify({\n                                type: 'copy',\n                            }));\n                        }\n                        return;\n                    }\n                    e.preventDefault();\n                    if (e.type === \"mousedown\" && contextMenuDiv.classList.contains('show')) {\n                        console.log('remove context menu');\n                        contextMenuDiv.classList.remove('show');\n                        return;\n                    }\n                    ")
		jteOutput.writeContent("\n                    if (e.type === \"mousedown\" && e.button === 2) return;\n                    const rect = frame.getBoundingClientRect();\n                    const clickX = e.clientX !== undefined ? e.clientX - rect.left : 0;\n                    const clickY = e.clientY !== undefined ? e.clientY - rect.top : 0;\n                    socket.send(JSON.stringify({\n                        type: 'event',\n                        eventType: e.type,\n                        clickX,\n                        clickY,\n                        button: e.button,\n                        ctrlKey: e.ctrlKey,\n                        shiftKey: e.shiftKey,\n                        altKey: e.altKey,\n                        metaKey: e.metaKey,\n                        key: e.key,\n                        clientX: e.clientX,\n                        clientY: e.clientY,\n                        deltaY: reverseToggle.checked && typeof e.deltaY === 'number' ? -e.deltaY : e.deltaY,\n                    }));\n                    frameInput.focus();\n                };\n\n                const attachEvents = () => {\n                    console.log('Attaching event handlers to new document');\n                    const events = [\"mousedown\", \"mouseup\", \"mousemove\", \"wheel\", \"keydown\", \"keyup\"];\n                    for (const ev of events) {\n                        frameInput.addEventListener(ev, frameEvent, false);\n                    }\n\n                    let touch = undefined;\n                    frameInput.addEventListener('touchstart', e => {\n                        if (e.touches.length === 1) {\n                            touch = e.touches[0];\n                        }\n                    }, false);\n                    frameInput.addEventListener('touchend', e => {\n                        touch = undefined;\n                    }, false);\n                    frameInput.addEventListener('touchmove', e => {\n                        if (e.touches.length === 1 && touch !== undefined) {\n                            e.preventDefault();\n                            let deltaX = touch.pageX - e.touches[0].pageX;\n                            let deltaY = touch.pageY - e.touches[0].pageY;\n                            if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                                ")
		jteOutput.writeContent("\n                                socket.send(JSON.stringify({\n                                    type: 'event',\n                                    eventType: 'wheel',\n                                    clickX: e.touches[0].pageX,\n                                    clickY: e.touches[0].pageY,\n                                    shiftKey: true,\n                                    clientX: e.touches[0].clientX,\n                                    clientY: e.touches[0].clientY,\n                                    deltaY: deltaX,\n                                }));\n                            } else {\n                                socket.send(JSON.stringify({\n                                    type: 'event',\n                                    eventType: 'wheel',\n                                    clickX: e.touches[0].pageX,\n                                    clickY: e.touches[0].pageY,\n                                    clientX: e.touches[0].clientX,\n                                    clientY: e.touches[0].clientY,\n                                    deltaY: deltaY,\n                                }));\n                            }\n                            touch = e.touches[0];\n                        }\n                    }, false);\n                    ")
		jteOutput.writeContent("\n                    ")
		jteOutput.writeContent("\n                    ")
		jteOutput.writeContent("\n                    frameInput.addEventListener('input', e => {\n                        e.preventDefault();\n                        socket.send(JSON.stringify({\n                            type: 'paste',\n                            data: e.data,\n                        }));\n                        e.target.value = '';\n                    });\n                    frameInput.addEventListener('contextmenu', e => {\n                        e.preventDefault();\n                        contextMenuDiv.style.left = e.offsetX + 'px';\n                        contextMenuDiv.style.top = e.offsetY + 'px';\n                        contextMenuDiv.classList.add('show');\n\n                        const shiftLeft = contextMenuDiv.offsetParent.offsetWidth - contextMenuDiv.offsetWidth - contextMenuDiv.offsetLeft;\n                        if (shiftLeft < 0)\n                            contextMenuDiv.style.left = (e.offsetX + shiftLeft) + 'px';\n                        const shiftTop = contextMenuDiv.offsetParent.offsetHeight - contextMenuDiv.offsetHeight - contextMenuDiv.offsetTop;\n                        if (shiftTop < 0)\n                            contextMenuDiv.style.top = (e.offsetY + shiftTop) + 'px';\n                    }, false);\n                };\n                attachEvents();\n                frameInput.focus();\n                loadUrl(url);\n            } catch (e) {\n                messageDiv.textContent = \"")
		jteOutput.setContext("script", null)
		jteOutput.writeUserContent(MR.strings.label_error.localized(locale))
		jteOutput.writeContent(": \" + (e.message || e.reason || e);\n                messageDiv.classList.add('error');\n                console.error(e);\n            }\n        })();\n    </script>\n</body>\n</html>\n")
	}
	@JvmStatic fun renderMap(jteOutput:gg.jte.html.HtmlTemplateOutput, jteHtmlInterceptor:gg.jte.html.HtmlInterceptor?, params:Map<String, Any?>) {
		val locale = params["locale"] as java.util.Locale
		render(jteOutput, jteHtmlInterceptor, locale);
	}
}
}
